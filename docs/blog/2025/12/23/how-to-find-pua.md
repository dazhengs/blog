# 如何发现你电脑中的 PUA 软件

我也是最近才了解到 PUA 软件，这个是微软定义的，全称叫 Potentially Unwanted Application，也就是指潜在的不受欢迎的应用。那些偷看你电脑文件的应用都是 PUA，今天来说一下如何发现这类 PUA，仅适用于 Windows。macOS 几乎没有 PUA。

故事要从我的朋友阿强说起。

上周五晚上，阿强火急火燎地给我发微信：“大征哥，救命！我觉得我的电脑被人‘监控’了。”

我问他咋回事。他说，最近为了处理文档，他在网上随便下了一个“免费且功能强大”的 PDF 转换器。软件确实能用，但他发现了一个诡异的现象：只要这软件一开，哪怕什么都不干，硬盘指示灯就在疯狂闪烁，风扇呼呼转，甚至连浏览器打开淘宝都变卡了。

“是不是中病毒了？”阿强问。

他用某某杀毒软件扫了一遍，结果显示：安全，无威胁。

“这就离谱了，”阿强很绝望，“明明感觉有个贼在家里翻箱倒柜，但保安却说家里没人。”

我笑了笑，给他发过去一个只有 2MB 大小的压缩包，我说：“杀毒软件看的是‘黑名单’（是不是已知病毒），但我们要抓的是‘流氓’（PUA）。对付这种手脚不干净的软件，你需要一把‘显微镜’。”

这个显微镜，就是微软 Sysinternals 工具集中大名鼎鼎的神器——Process Monitor (简称 Procmon)。

很多读者可能都知道“任务管理器”。

如果把操作系统比作一座繁忙的大厦， 任务管理器就像是大厦门口的保安。他只能告诉你：现在大楼里有几个人（进程），谁占的地方大（内存），谁跑得快（CPU）。但他不知道这些人在房间里具体干了什么。

而 Procmon 则是遍布大厦每个角落的 4K 高清监控摄像头。

它能记录下 Windows 系统里发生的每一次文件读写、每一次注册表修改、每一次网络连接。

不管那个流氓软件把自己伪装得多么人畜无害，只要它想在你的硬盘上偷看一眼你的隐私文件，Procmon 就会像法医一样，精准地记录下：

“XX 分 XX 秒，某个进程，试图打开某个文件，结果是成功还是失败。”

在 Procmon 面前，没有任何“小动作”能隐形。

回到阿强的电脑上。我们要解决的问题很明确：那个“PDF 转换器”，到底在偷偷读写什么文件？

为什么我们要关注“文件读写”？

> 所谓的 PUA（Potentially Unwanted Application），往往具有侵入性。
> 如果一个单纯的 PDF 工具，去读取你的浏览器 Cookie（为了偷账号）、扫描你的“我的文档”（为了偷资料）、或者频繁写入系统临时目录（为了挖矿或植入广告），那它就是不折不扣的 PUA。

我带着阿强进行了如下操作，大家也可以拿小本本记下来，这是抓“内鬼”的标准姿势：

打开 Procmon，瞬间屏幕上会像《黑客帝国》的代码雨一样滚动——因为系统每秒钟发生的事件太多了！别慌，先按 `Ctrl+E` 暂停捕获，我们要先“清场”。

我们不想看系统正常运行的日志，我们只想盯着那个可疑的 PDF 软件。

我在 Filter 菜单里设置了两个条件：

- Process Name（进程名）包含 `pdf` (假设那个软件叫 SuperPDF.exe) -> Include
- Operation（操作）包含 `ReadFile` (我们要看它读了什么) -> Include

再次点击捕获（Capture）（快捷键：`Ctrl+E`），然后让阿强操作那个 PDF 软件。

仅仅过了几秒钟，Procmon 的列表里跳出了几千条记录。我眼尖，立刻锁定了几行刺眼的红字（为了方便理解，我翻译了一下）：

- **时间：** 22:15:30
- **进程：** SuperPDF.exe
- **动作：** ReadFile
- **路径：** `C:\Users\阿强\AppData\Local\Google\Chrome\User Data\Default\Cookies`
- **路径：** `C:\Users\阿强\Desktop\工资条.xlsx`

阿强看着屏幕，冷汗都下来了：“大征哥，它一个转换 PDF 的，读我的 Chrome 浏览器 Cookie 干什么？还读我桌面的 工资条？！”

“这就是实锤，”我淡定地截图，“这就是典型的 PUA 行为。它在后台扫描你的敏感数据，不仅侵犯隐私，大量的无效读取操作也拖慢了系统速度。”

它没有直接破坏系统（所以杀毒软件不报毒），但它在窃取。

那天晚上，阿强卸载了那个流氓软件，换了一个开源干净的工具，电脑瞬间安静了，浏览器也丝滑了。

Procmon 这个工具，虽然界面甚至有点复古，但它代表了技术人员的一种态度：**掌控权**。

在如今这个 App 都在想方设法获取权限、甚至连手电筒都要读取通讯录的时代，我们太容易放弃抵抗，习惯了“它是为了我好”。

但 Procmon 告诉我们：不要猜测，要去验证。

当你学会使用 Procmon，你就拥有了透视数字世界的眼睛。你可以清楚地看到，谁在尊重你，谁在窥探你。

每个工具的诞生，都是一次对混乱的温柔反抗。希望你也能用好这把“显微镜”，守住自己电脑里的那方净土。

附 Procmon 微软官方下载链接，目前的版本是 v4.01：
https://learn.microsoft.com/en-us/sysinternals/downloads/procmon
